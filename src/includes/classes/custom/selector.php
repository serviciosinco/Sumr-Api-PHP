<?php class CRM_Slc extends CRM_Cl{function __construct(){parent::__construct();}function __destruct(){parent::__destruct();}public function _attr($p=NULL){if(!isN($p["a"])){foreach($p["a"] as $_attr_k=>$_attr_v){$html_attr .= " ".$_attr_k."='".$_attr_v."' ";}}return $html_attr;}public function _slcbx($p=NULL){if($p["rq"]=="ok"){$Rq="";}else{$Rq=FMRQD;}if($p["m"]=="ok"||$p["m"]=="sch"){$__m=" size='7' multiple='multiple' ";$__nm=$p["id"]."[]";}else{$__m="";$__nm=$p["id"];}$_lb=Lb($p["ph"]);$_r=$_lb."<select name='".$__nm."' data-placeholder='".$p["ph"]."' id='".$p["id"]."' ".$__m." ".$this->_attr([ "a"=>$p["attr"] ])." ".$Rq." autocomplete='off' >";$_r .= $p["c"];$_r .= "</select>";return($_r);}public function _ovlu($p=NULL){if($p["c"] != ""){$__c=" class='".$p["c"]."' ";}if($p["s"] == "ok"){$__sl=HTML_SLCT;}if($p["ct"] != "off"){$__t=ctjTx($p["t"],"in");}else{$__t=$p["t"];}if(!isN($p["attr"])){foreach($p["attr"] as $_attr_k=>$_attr_v){$__attr .= " ".$_attr_k."='".$_attr_v."' ";}}$_r="<option value='".$p["v"]."' ".$__sl." ".$__c." ".$__attr.">".$__t."</option>";return($_r);}public function _js($p=NULL){if(!isN($p)&&!isN($p["id"])){if($p["tk"]){$__tkn=',tokenSeparators:[","," "] ';}if($p["tr"]){$__trs=',templateResult:'.$p["tr"].',templateSelection:'.$p["tr"].' ';}if($p["ac"]!="no"){$__clr='true';}else{$__clr='false';}if(!isN($p["thm"])){$__thm=" theme:'".$p["thm"]."',";}$_r='$("#'.$p["id"].' ").select2({'.$__thm.' allowClear:'.$__clr.',placeholder:"'.$p["ph"].'" '.$__tkn.' '.$__trs.'});';return($_r);}}public function _bld($p=NULL){global $__cnx;if(!isN($p)&&!isN($p["q"])){$Qry=$p["q"];$Ls=$__cnx->_qry($Qry);if($Ls){$rLs=$Ls->fetch_assoc();$TLs=$Ls->num_rows;$lbld .= $this->_ovlu([ "ct"=>"off" ]);do{if (!(strcmp($rLs[$p["v"]],$p["va"]))){$_slc="ok";}else{$_slc="no";}$lbld .= $this->_ovlu([ "t"=>$rLs[$p["nm"]],"v"=>$rLs[$p["v"]],"s"=>$_slc ]);}while ($rLs=$Ls->fetch_assoc());if($TLs>0){$Ls->data_seek(0);$rLs=$Ls->fetch_assoc();}if($p["mlt"]=="ok"){$cls=DV_CLSS_SLCT_MLT;}else{$cls=DV_CLSS_SLCT_BX;}$_bxc=$this->_slcbx([ "id"=>$p["id"],"ph"=>$p["ph"],"rq"=>$p["rq"],"c"=>$lbld,"m"=>$p["mlt"] ]);$html=bdiv([ "c"=>$_bxc,"cls"=>$cls ]);$Ls->free;$this->js .= $this->_js([ "id"=>$p["id"],"ph"=>$p["ph"] ]);return $html;}}}public function UsNvl($p=NULL){global $__cnx;$_r=$this->_bld([ "id"=>(!isN($p["id"])?$p["id"]:"us_nivel"),"q"=>"SELECT * FROM "._BdStr(DBM).TB_US_NVL." ORDER BY usnvl_nm ASC","v"=>(!isN($p["v"])?$p["v"]:"usnvl_nm"),"va"=>(!isN($p["va"])?$p["va"]:"us_nivel"),"nm"=>"usnvl_nm","rq"=>"ok","ph"=>FM_LS_SLNVL ]);return $_r;}public function CdDp($p=NULL){global $__cnx;$_r=$this->_bld([ "id"=>(!isN($p["id"])?$p["id"]:"cd_dp"),"q"=>"SELECT * FROM ".MDL_SIS_CD_DP_BD." ORDER BY cddp_tt ASC","v"=>(!isN($p["v"])?$p["v"]:"id_cddp"),"va"=>(!isN($p["va"])?$p["va"]:"cd_dp"),"nm"=>"cddp_tt","rq"=>"ok","ph"=>FM_LS_SLNVL ]);return $_r;}public function Sis_SiNo($p=NULL){global $__cnx;$_r=$this->_bld([ "id"=>(!isN($p["id"])?$p["id"]:"sis_sino"),"q"=>"SELECT * FROM ".TB_SIS_SINO." WHERE id_sissino != 3 ORDER BY id_sissino ASC","v"=>(!isN($p["v"])?$p["v"]:"id_sissino"),"va"=>(!isN($p["va"])?$p["va"]:"sis_sino"),"nm"=>"sissino_tt","rq"=>"ok","ph"=>FM_LS_SLNVL ]);return $_r;}public function Sis_Noi($p=NULL){global $__cnx;$_r=$this->_bld([ "id"=>(!isN($p["id"])?$p["id"]:"sis_noi"),"q"=>"SELECT * FROM ".MDL_NOI_BD." WHERE id_cntnoi != '1' $__fl ORDER BY cntnoi_nm ASC","v"=>(!isN($p["v"])?$p["v"]:"id_cntnoi"),"va"=>(!isN($p["va"])?$p["va"]:"sis_noi"),"nm"=>"cntnoi_nm","rq"=>"ok","ph"=>FM_LS_SLNVL ]);return $_r;}public function TexTp($p=NULL){global $__cnx;$_r=$this->_bld([ "id"=>(!isN($p["id"])?$p["id"]:"tex_tp"),"q"=>"SELECT * FROM ".TB_SIS_TX_TP." ORDER BY textp_tt ASC","v"=>(!isN($p["v"])?$p["v"]:"id_textp"),"va"=>(!isN($p["va"])?$p["va"]:"tex_tp"),"nm"=>"textp_tt","rq"=>"ok","ph"=>FM_LS_SLNVL ]);return $_r;}public function Cd($p=NULL){global $__cnx;$_r=$this->_bld([ "id"=>(!isN($p["id"])?$p["id"]:"cd"),"q"=>"SELECT * FROM ".DL_SIS_CD_BD.",".MDL_SIS_CD_DP_BD." WHERE cd_dp=id_cddp ORDER BY cd_tt ASC","v"=>(!isN($p["v"])?$p["v"]:"id_cd"),"va"=>(!isN($p["va"])?$p["va"]:"cd"),"nm"=>"cd_tt","rq"=>"ok","ph"=>FM_LS_SLNVL ]);return $_r;}public function UpEst($p=NULL){global $__cnx;$_r=$this->_bld([ "id"=>(!isN($p["id"])?$p["id"]:"up_est"),"q"=>"SELECT * FROM ".MDL_UP_EST_BD." WHERE id_upest != '' ORDER BY id_upest ASC","v"=>(!isN($p["v"])?$p["v"]:"up_est"),"va"=>(!isN($p["va"])?$p["va"]:"up_est"),"nm"=>"upest_nm","rq"=>"ok","ph"=>FM_LS_SLNVL ]);return $_r;}public function SisGrph($p=NULL){global $__cnx;$_r=$this->_bld([ "id"=>(!isN($p["id"])?$p["id"]:"grphchrrlc_chr"),"q"=>"SELECT * FROM ".MDL_GRPH_CHR_BD." WHERE id_grphchr != '' ORDER BY grphchr_tt ASC","v"=>(!isN($p["v"])?$p["v"]:"up_est"),"va"=>(!isN($p["va"])?$p["va"]:"grphchrrlc_chr"),"nm"=>"grphchr_tt","rq"=>"ok","ph"=>FM_LS_SLNVL ]);return $_r;}public function SisTpDt($p=NULL){global $__cnx;$_r=$this->_bld([ "id"=>(!isN($p["id"])?$p["id"]:"sisslctpf_tpd"),"q"=>"SELECT * FROM ".MDL_SIS_TP_DT_BD." ORDER BY sistpdt_tt ASC","v"=>(!isN($p["v"])?$p["v"]:"id_sistpdt"),"va"=>(!isN($p["va"])?$p["va"]:"sisslctpf_tpd"),"nm"=>"sistpdt_tt","rq"=>"ok","ph"=>FM_LS_SLNVL ]);return $_r;}public function SisMdTp($p=NULL){global $__cnx;$_r=$this->_bld([ "id"=>(!isN($p["id"])?$p["id"]:"sismd_tp"),"q"=>"SELECT * FROM ".TB_SIS_MD_TP." ORDER BY sismdtp_tt ASC","v"=>(!isN($p["v"])?$p["v"]:"id_sismdtp"),"va"=>(!isN($p["va"])?$p["va"]:"sismd_tp"),"nm"=>"sismdtp_tt","rq"=>"ok","ph"=>FM_LS_SLNVL ]);return $_r;}public function Sis_Sx($p=NULL){global $__cnx;$_r=$this->_bld([ "id"=>(!isN($p["id"])?$p["id"]:"mdlcnt_dcto"),"q"=>"SELECT * FROM "._BdStr(DBM).MDL_DCTO_BD." WHERE id_dcto != '' ORDER BY dcto_nm ASC","v"=>(!isN($p["v"])?$p["v"]:"id_dcto"),"va"=>(!isN($p["va"])?$p["va"]:"mdlcnt_dcto"),"nm"=>"sissx_tt","rq"=>"ok","ph"=>FM_LS_SLNVL ]);return $_r;}public function Sis_Tel($p=NULL){global $__cnx;$_r=$this->_bld([ "id"=>(!isN($p["id"])?$p["id"]:"cnttel_tp"),"q"=>"SELECT * FROM ".MDL_SIS_TEL_BD." WHERE id_sistel != '1' ORDER BY sistel_nm","v"=>(!isN($p["v"])?$p["v"]:"id_sistel"),"va"=>(!isN($p["va"])?$p["va"]:"cnttel_tp"),"nm"=>"sistel_nm","rq"=>"ok","ph"=>FM_LS_SLNVL ]);return $_r;}public function SisPay($p=NULL){global $__cnx;$_r=$this->_bld([ "id"=>(!isN($p["id"])?$p["id"]:"bn_pay"),"q"=>"SELECT * FROM ".TB_SIS_PAY_EST." WHERE id_sispayest != '' ORDER BY sispayest_tt ASC","v"=>(!isN($p["v"])?$p["v"]:"id_sispayest"),"va"=>(!isN($p["va"])?$p["va"]:"bn_pay"),"nm"=>"sispayest_tt","rq"=>"ok","ph"=>FM_LS_SLNVL ]);return $_r;}public function Cl($p=NULL){global $__cnx;$_r=$this->_bld([ "id"=>(!isN($p["id"])?$p["id"]:"dshmtrccl_cl"),"q"=>"SELECT * FROM ".TB_CL." WHERE id_cl != '' ORDER BY cl_nm ASC","v"=>(!isN($p["v"])?$p["v"]:"id_cl"),"va"=>(!isN($p["va"])?$p["va"]:"dshmtrccl_cl"),"nm"=>"cl_nm","rq"=>"ok","ph"=>FM_LS_SLNVL ]);return $_r;}public function Sis_Dcto($p=NULL){global $__cnx;$_r=$this->_bld([ "id"=>(!isN($p["id"])?$p["id"]:"mdlcnt_dcto"),"q"=>"SELECT * FROM "._BdStr(DBM).MDL_DCTO_BD." WHERE id_dcto != '' ORDER BY dcto_nm ASC","v"=>(!isN($p["v"])?$p["v"]:"id_dcto"),"va"=>(!isN($p["va"])?$p["va"]:"mdlcnt_dcto"),"nm"=>"dcto_nm","rq"=>"ok","ph"=>FM_LS_SLNVL ]);return $_r;}public function SisMnuTp($p=NULL){global $__cnx;$_r=$this->_bld([ "id"=>(!isN($p["id"])?$p["id"]:"clmnu_tp"),"q"=>"SELECT * FROM ".TB_SIS_MNU_TP."<br /> WHERE id_sismnutp != '' ORDER BY sismnutp_tt ASC","v"=>(!isN($p["v"])?$p["v"]:"id_sismnutp"),"va"=>(!isN($p["va"])?$p["va"]:"clmnu_tp"),"nm"=>"sismnutp_tt","rq"=>"ok","ph"=>FM_LS_SLNVL ]);return $_r;}public function EstCnt($p=NULL){global $__cnx;$_r=$this->_bld([ "id"=>(!isN($p["id"])?$p["id"]:"cntest_tp"),"q"=>"SELECT * FROM ".TB_SIS_CNT_EST_TP." INNER JOIN ".TB_CL."<br /> ON cntesttp_cl=id_cl WHERE id_cntesttp != '' <br /> AND cl_enc=".DB_CL_ENC." ORDER BY cntesttp_tt ASC","v"=>(!isN($p["v"])?$p["v"]:"id_cntesttp"),"va"=>(!isN($p["va"])?$p["va"]:"cntest_tp"),"nm"=>"cntesttp_tt","rq"=>"ok","ph"=>FM_LS_SLNVL ]);return $_r;}public function CntEst($p=NULL){global $__cnx;$_r=$this->_bld([ "id"=>(!isN($p["id"])?$p["id"]:"cntest_tp"),"q"=>"SELECT * FROM ".TB_SIS_CNT_EST_TP." INNER JOIN ".TB_CL." ON cntesttp_cl=id_cl WHERE id_cntesttp != '' AND cl_enc=".DB_CL_ENC." ORDER BY cntesttp_tt ASC","v"=>(!isN($p["v"])?$p["v"]:"id_cntesttp"),"va"=>(!isN($p["va"])?$p["va"]:"cntest_tp"),"nm"=>"cntesttp_tt","rq"=>"ok","ph"=>FM_LS_SLNVL ]);return $_r;}public function UsEst($p=NULL){global $__cnx;$_r=$this->_bld([ "id"=>(!isN($p["id"])?$p["id"]:"us_est"),"q"=>"SELECT * FROM ".TB_US_EST." ORDER BY usest_tt ASC","v"=>(!isN($p["v"])?$p["v"]:"id_usest"),"va"=>(!isN($p["va"])?$p["va"]:"us_est"),"nm"=>"usest_tt","rq"=>"ok","ph"=>FM_LS_SLNVL ]);return $_r;}public function Grph($p=NULL){global $__cnx;$_r=$this->_bld([ "id"=>(!isN($p["id"])?$p["id"]:"dshgrph_tp"),"q"=>"SELECT * FROM ".MDL_GRPH_BD." WHERE id_grph != '' ORDER BY grph_tt ASC","v"=>(!isN($p["v"])?$p["v"]:"id_grph"),"va"=>(!isN($p["va"])?$p["va"]:"dshgrph_tp"),"nm"=>"grph_tt","rq"=>"ok","ph"=>FM_LS_SLNVL ]);return $_r;}}?>